<header
  [jtSpaceTrigger]="playPause.bind(this)"
  *ngIf="!stepper.running" class="preset-title">
  <h1>{{preset.title}}</h1>
</header>
<div
  [jtSpaceTrigger]="playPause.bind(this)"
  [@fadeToggle]="stepper.stepNumber" *ngIf="!initial" class="main-body">
  <section  *ngIf="!initial" class="section section--col">
    <div
      title="exercise in progress"
      [@pulsation]="stepper.countdown"
      [ngStyle]="{
        'color': stepper.currentStep.type === 'work'
          ? stepper.currentStep.color
          : 'var(--rest)'
        }"
      class="step-current">
      {{
        stepper.currentStep.type === 'work'
        ? stepper.currentStep.title
        : stepper.currentStep.type
      }}
    </div>
    <mat-icon
      title="next exercise"
      class="arrow"
      [ngStyle]="{
        'color': stepper.nextStep.type === 'work'
          ? stepper.nextStep.color
          : 'var(--rest)'
      }"
      *ngIf="stepper.stepNumber < stepper.steps.length
        && stepper.stepNumber !== 0">
      arrow_downward
    </mat-icon>
    <div
      title="next exercise"
      class="step-next"
      [ngStyle]="{
        'color': stepper.nextStep.type === 'work'
          ? stepper.nextStep.color
          : 'var(--rest)'
      }">
      {{
        stepper.nextStep.type === 'work'
          ? stepper.nextStep.title
          : stepper.nextStep.type
      }}
    </div>
  </section>
  <section  *ngIf="!initial" class="section">
    <div
      [ngStyle]="{
        'color': stepper.currentStep.type === 'work'
          ? stepper.currentStep.color
          : 'var(--rest)'
        }"
      class="countdown">
      {{stepper.countdown}}
    </div>
    <div class="">
      <div title="time elapsed" class="elapsed">
        {{stepper.presetTotalTime.elapsed}}
      </div>
      <div title="time remaining" class="remaining">
        {{stepper.presetTotalTime.remaining}}
      </div>
    </div>
  </section>
  <section  *ngIf="!initial" class="section section--progress">
    <div title="timers elapsed" class="current-number">
      {{stepper.stepNumber}}
    </div>
    <div class="progress">
      <mat-progress-spinner
        [diameter]="40" mode="determinate"
        color="accent" [value]="stepper.progress">
      </mat-progress-spinner>
    </div>
    <div title="timers remaining" class="current-number">
      {{stepper.steps.length - stepper.stepNumber}}
    </div>
  </section>
  <section  *ngIf="!initial" class="section section--play-stop">
    <button
      title="play"
      *ngIf="!stepper.running"
      [disabled]="!stepper.steps.length"
      (click)="play()"
      mat-fab>
      <mat-icon>play_arrow</mat-icon>
    </button>
    <button
      title="pause"
      *ngIf="stepper.running"
      (click)="pause()"
      mat-fab>
      <mat-icon>pause</mat-icon>
    </button>
    <button
      title="stop"
      color="warn"
      [disabled]="!stepper.steps.length"
      (click)="stop()"
      mat-fab>
      <mat-icon>stop</mat-icon>
    </button>
  </section>
</div>
<section *ngIf="initial" class="section section--prestart">
  <div [@prestart]="stage">
    <button
      title="start"
      class="large"
      *ngIf="!launched"
      (click)="start()"
      [disabled]="launched"
      mat-icon-button>
      <mat-icon>play_arrow</mat-icon>
    </button>
    <div
      *ngIf="stage !== 'button'"
      class="prestart-countdown">
      {{stage}}
    </div>
  </div>
  <div class="time-stat" *ngIf="!launched">
    <mat-icon
      title="total time of preset"
      color="primary">access_time</mat-icon>
      {{stepper.presetTotalTime.remaining}} =
    <mat-icon title="total work time" color="warn">directions_run</mat-icon>
    {{stepper.secondsTommssStr(stepper.workTotalTime)}} +
    <jt-svg-ico
      title="total rest time"
      class="rest-icon"
      icoName="resting-man-green">
    </jt-svg-ico>
    {{stepper.secondsTommssStr(stepper.restTotalTime)}}
  </div>
</section>
<div [@finish]="stage" *ngIf="stage === 'accomplished'" class="finish">
  <div class="done">
    {{'accomplished' | uppercase}}
  </div>
  <button
    title="reset"
    class="replay large"
    (click)="stop()"
    mat-icon-button>
    <mat-icon>replay</mat-icon>
  </button>
</div>
