<header [jtSpaceTrigger]="playPause.bind(this)" *ngIf="!stepper.running" class="preset-title">
  <h1>{{preset.title}}</h1>
</header>
<div [jtSpaceTrigger]="playPause.bind(this)" [@fadeToggle]="stepper.stepNumber" *ngIf="!initial" class="main-body">
  <section  *ngIf="!initial" class="section section--col">
    <div [@pulsation]="stepper.countdown" [ngStyle]="{'color': stepper.currentStep.type === 'work' ? stepper.currentStep.color : 'var(--rest)'}" class="step-current">
      {{stepper.currentStep.type === 'work' ? stepper.currentStep.title : stepper.currentStep.type}}
    </div>
    <mat-icon class="arrow" [ngStyle]="{'color': stepper.nextStep.type === 'work' ? stepper.nextStep.color : 'var(--rest)'}" *ngIf="stepper.stepNumber < stepper.steps.length && stepper.stepNumber !== 0">arrow_downward</mat-icon>
    <div class="step-next" [ngStyle]="{'color': stepper.nextStep.type === 'work' ? stepper.nextStep.color : 'var(--rest)'}">
      {{stepper.nextStep.type === 'work' ? stepper.nextStep.title : stepper.nextStep.type}}
    </div>
  </section>
  <section  *ngIf="!initial" class="section">
    <div [ngStyle]="{'color': stepper.currentStep.type === 'work' ? stepper.currentStep.color : 'var(--rest)'}"  class="countdown">
      {{stepper.countdown}}
    </div>
    <div class="">
      <div class="elapsed">
        {{stepper.presetTotalTime.elapsed}}
      </div>
      <div class="remaining">
        {{stepper.presetTotalTime.remaining}}
      </div>
    </div>
  </section>
  <section  *ngIf="!initial" class="section section--progress">
    <div class="current-number">
      {{stepper.stepNumber}}
    </div>
    <div class="progress">
      <mat-progress-spinner [diameter]="40" mode="determinate" color="accent" [value]="stepper.progress"></mat-progress-spinner>
    </div>
    <div class="current-number">
      {{stepper.steps.length - stepper.stepNumber}}
    </div>
  </section>
  <section  *ngIf="!initial" class="section section--play-stop">
    <button
      *ngIf="!stepper.running"
      [disabled]="!stepper.steps.length"
      (click)="play()"
      mat-fab>
      <mat-icon>play_arrow</mat-icon>
    </button>
    <button
      *ngIf="stepper.running"
      (click)="pause()"
      mat-fab>
      <mat-icon>pause</mat-icon>
    </button>
    <button
      color="warn"
      [disabled]="!stepper.steps.length"
      (click)="stop()"
      mat-fab>
      <mat-icon>stop</mat-icon>
    </button>
  </section>
</div>
<section *ngIf="initial" class="section section--prestart">
  <div [@prestart]="stage">
    <button
      class="large"
      *ngIf="!launched"
      (click)="start()"
      [disabled]="launched"
      mat-icon-button>
      <mat-icon>play_arrow</mat-icon>
    </button>
    <div
      *ngIf="stage !== 'button'"
      class="prestart-countdown">
      {{stage}}
    </div>
  </div>
  <div class="time-stat" *ngIf="!launched">
    <mat-icon color="primary">access_time</mat-icon> {{stepper.presetTotalTime.remaining}} =
    <mat-icon color="warn">directions_run</mat-icon> {{stepper.secondsTommssStr(stepper.workTotalTime)}} +
    <jt-svg-ico
      class="rest-icon"
      icoName="resting-man-green">
    </jt-svg-ico>
    {{stepper.secondsTommssStr(stepper.restTotalTime)}}
  </div>
</section>
<div [@finish]="stage" *ngIf="stage === 'accomplished'" class="finish">
  <div class="done">
    {{'accomplished' | uppercase}}
  </div>
  <button
    class="replay large"
    (click)="stop()"
    mat-icon-button>
    <mat-icon>replay</mat-icon>
  </button>
</div>
